{% extends "base.html" %}
{% block body %}

<div id="shop-nav" class="sidenav">
  <a onclick="closeShopNav()" id="close-shop-nav"><div style="color:white;"><i class="fa fa-window-close"></i></div></a>
  <a href="{% url 'products:list' category='list'%}">Alt</a>
  <a href="{% url 'products:list' category='sticker' %}" >Stickers</a>
  <a href="{% url 'products:list' category='tshirt' %}">Merch</a>
  <a href="{% url 'carts:cart-home' %}"><i class="fa fa-shopping-cart"></i></a>
</div>
<div class="container" style="text-align: center;">
  <div class="shop-top-buttons">
    <a href="#" class="btn btn-info" onclick="openShopNav()">Kategorier <i class="fa fa-air-freshener"></i></a>
    <a href="{% url 'carts:cart-home' %}" class="btn btn-info">Handlekurv <i class="fas fa-shopping-cart"></i></a>
  </div>
  <div class="meet-list-container">
  {% for i in object_list %}
  <div class="meet-card-container" style="background-image: url('{{i.get_list_image}}');background-position:center;">
        <div class="meet-card-container-color-overlay" style="background-color:rgba(0,0,0,0.3);">
            <div class="meet-card-title">
                <a class="w" href=‘{{product.get_absolute_url}}’><h3>{{i.name}}</h3></a>
            </div>
            <div class="meet-card-imagecontainer" style=" border: 0.3px solid white;; background-image: url('{{i.get_list_image}}'); background-position:center;">
            </div>
            <div class="meet-card-timecontainer">
            </div>
            <h4 class="meet-card-location w">
            {{i.name}}
            </h4>
    <a href="#" id="buyProduct" data-pk="{{i.id}}" class="btn btn-info"><i class="fa fa-shopping-cart"></i></a>
		<a href="{% url 'products:detail' category='shady' slug=i.slug %}" class="btn btn-info">Mer info</a>
      <div class="meet-card-bottom-info">
        <p class="w"> {{i.price}} kr </p>
      </div>
    </div>
</div>
  {% endfor %}
</div>
</div>
{% endblock %}
{% block script%}
<script>
function openShopNav() {
    var w = window.innerWidth;
    var width = "250px";
    if(w < 450){
      width = "50%";
    }
    document.getElementById("shop-nav").style.width = width;
}

/* Set the width of the side navigation to 0 */
function closeShopNav() {
    document.getElementById("shop-nav").style.width = "0";
}
$(document).ready(function(){

  $(document.body).on('click', '#buyProduct', function(event){
    event.preventDefault()
    console.log("HEELO")
    var id = $(this).attr("data-pk");
    var data = {
        'pk':id,
        csrfmiddlewaretoken:'{{ csrf_token }}'

    }
    $(this).html("<i class='fa fa-spinner'></i>");

    $.ajax({
      url:'../../cart/add/' + id + '/',
      method: 'POST',
      data: data,
      success:function(data){
        $(this).html("Lagt til!");
      }, error:function(error){
        console.log(error)
      }
    })
    $(this).html("Lagt til!");

  })
});

</script>

{% endblock %}
