{% extends "base.html" %}
{% block body %}
<div class="container">
  <a href="{% url 'carts:cart-home' %}" class="btn btn-info" style="display:block;">Shopping Bag</a>
  {% for i in object_list %}
  <div class="card" style="width: 18rem; display:inline-block;">
  <img class="card-img-top" src="{{i.get_list_image}}" alt="Card image cap">
    <div class="card-body">
      <h5 class="card-title">{{i.name}}</h5>
      <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
      <a href="{% url 'products:detail' category='shady' slug=i.slug %}" class="btn btn-info">Mer info</a>
      <a href="#" id="buyProduct" data-pk="{{i.id}}" class="btn btn-info"><i class="fa fa-shopping-cart"></i></a>
    </div>
    </div>
  {% endfor %}
  <div class="container">
    <a href="{% url 'products:list' category='list'%}" class="btn btn-warning">List</a>
    <a href="{% url 'products:list' category='sticker' %}" class="btn btn-info">sticker</a>
    <a href="{% url 'products:list' category='tshirt' %}" class="btn btn-info">tshirt</a>
  </div>
</div>
{% endblock %}
{% block script%}
<script>
$(document).ready(function(){

  $(document.body).on('click', '#buyProduct', function(event){
    event.preventDefault()
    var id = $(this).attr("data-pk");
    var data = {
        'pk':id,
        csrfmiddlewaretoken:'{{ csrf_token }}'

    }
    $(this).html("<i class='fa fa-spinner'></i>");

    $.ajax({
      url:'../../cart/add/' + id + '/',
      method: 'POST',
      data: data,
      success:function(data){
        $(this).html("Lagt til!");
      }, error:function(error){
        console.log(error)
      }
    })
    $(this).html("Lagt til!");

  })
});

</script>

{% endblock %}
